<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Amor</title>

<style>
body {
  margin: 0;
  background:
    radial-gradient(circle at 20% 30%, rgba(160,0,0,0.25), transparent 40%),
    radial-gradient(circle at 80% 60%, rgba(140,0,0,0.15), transparent 45%),
    linear-gradient(135deg, #040000, #120000);
  background-size: 200% 200%;
  animation: venas 18s ease-in-out infinite;
  color: #d9d9d9;
  font-family: Arial, sans-serif;
}

@keyframes venas {
  0%   { background-position: 0% 50%; }
  50%  { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

/* Contenedor general */
.procedimiento {
  min-height: 100vh;
}

/* Latido del fondo */
.procedimiento.latido {
  animation: pulso 1.8s ease-in-out infinite;
}

@keyframes pulso {
  0%   { filter: brightness(1); }
  50%  { filter: brightness(1.08); }
  100% { filter: brightness(1); }
}

.sala {
  display: flex;
  justify-content: space-between;
  align-items: center;
  height: 100vh;
  padding: 40px;
}

.lado {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.lado img {
  width: 140px;
  filter: grayscale(100%);
  opacity: 0.85;
}

.corazon {
  max-width: 300px;
}

.corazon img {
  width: 100%;
  height: auto;
  image-rendering: auto;
  filter: contrast(110%);
  transition: transform 0.6s ease;
  cursor: pointer;
}

.corazon:hover img {
  transform: scale(1.08);
}

  /* Contenedor corazón + marcos */
.corazon-con-marcos {
  display: flex;
  align-items: center;
  gap: 15px;
}

/* Marco fijo de retrato */
.marco-retrato {
  min-width: 80px;
  min-height: 80px;
  padding: 18px;

  background:
    linear-gradient(145deg, #3a2b1a, #1c1208); /* madera oscura */

  border: 4px solid #5a3b1e;
  border-radius: 12px;

  box-shadow:
    inset 0 0 18px rgba(0,0,0,0.6),
    inset 0 0 4px rgba(255,220,180,0.15),
    0 0 22px rgba(0,0,0,0.6);

  display: inline-flex;
  align-items: center;
  justify-content: center;

  transition: all 0.35s ease;
}

.marco-retrato:not(:has(.papel-viejo)) {
  background:
    repeating-linear-gradient(
      45deg,
      #2b1c10,
      #2b1c10 8px,
      #24160c 8px,
      #24160c 16px
    );
}
  
.marco-retrato:has(.papel-viejo) {
  background:
    linear-gradient(145deg, #4a321a, #221508);

  box-shadow:
    inset 0 0 20px rgba(0,0,0,0.7),
    inset 0 0 10px rgba(255,200,150,0.25),
    0 0 35px rgba(140,60,20,0.5);
}

.marco-retrato:hover {
  transform: scale(1.02);
  box-shadow:
    inset 0 0 35px rgba(0,0,0,0.9),
    0 0 40px rgba(180,0,0,0.5);
}

.marco-retrato .papel-viejo {
  margin: 6px;
}

/* Papel viejo (movible) */
.papel-viejo {
  background: #f2e6c9;
  border: 1px solid #c2b280;
  padding: 8px;
  box-shadow:
    inset 0 0 20px rgba(120,80,40,0.4),
    0 6px 15px rgba(0,0,0,0.6);
  position: relative;
  cursor: grab;
}

.papel-viejo img {
  width: 120px;
  display: block;
  filter: sepia(40%) contrast(105%);
}

.zonas-libres {
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 40px;
  margin-top: 30px;
}

.zona-libre {
  width: 160px;
  height: 220px;
  background:
    radial-gradient(circle at 30% 30%, rgba(0,0,0,0.35), transparent 60%),
    rgba(30, 0, 0, 0.35);
  box-shadow:
    inset 0 0 25px rgba(0,0,0,0.6),
    0 0 15px rgba(120,0,0,0.15);
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.zona-libre:hover {
  background: rgba(255,255,255,0.05);
}

.palabra-secreta {
  text-align: center;
  margin-top: 20px;
  font-size: 42px;
  letter-spacing: 12px;
  font-family: "Times New Roman", serif;
}

.parte {
  opacity: 1;
  transition: opacity 1s ease;
}

.oculto {
  opacity: 0;
}

.mensaje {
  position: absolute;
  top: calc(50% + 240px);
  left: 50%;
  transform: translateX(-50%);
  text-align: center;
  font-size: 18px;
  opacity: 0;
  transition: opacity 0.5s ease;
  pointer-events: none;
}

.mensaje.visible {
  opacity: 1;
}

.centro {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.papel-viejo.bloqueado {
  opacity: 0.6;
  filter: sepia(80%) grayscale(30%);
  box-shadow: none;
}
  
</style>
</head>
  
<body>

<div class="palabra-secreta">
  <span id="parte1" class="parte oculto">Dmz</span>
  <span id="parte2" class="parte oculto">lñqz</span>
  <span id="parte3" class="parte oculto">cñr</span>
</div>

<div class="procedimiento" id="procedimiento">
  <div class="sala">

    <!-- IZQUIERDA -->
    <div class="lado">
      <div class="zonas-libres">
        <div class="zona-libre" id="zona1">
          <div class="papel-viejo" id="papel1" draggable="true" data-origen="1">
            <img src="img/Maximiliano_de_Habsburgo.jpg">
          </div>
        </div>
        <div class="zona-libre" id="zona2">
          <div class="papel-viejo" id="papel2" draggable="true" data-origen="2">
            <img src="img/Napoleon_bonaparte.jpg">
          </div>
        </div>
        <div class="zona-libre" id="zona3">
          <div class="papel-viejo" id="papel3" draggable="true" data-origen="3">
            <img src="img/Maximiliano_I.jpg">
          </div>
        </div>
      </div>
    </div>

    <!-- CENTRO -->
    <div class="corazon-con-marcos">

    <div class="marco-retrato dropzone" id="marco-izq"></div>

    <div class="centro">
      <div class="corazon">
        <img src="img/corazon.png">
      </div>

      <img id="final-img"
          src="img/Caeser.png"
          style="max-width: 200px; max-height: 200px; display:none; cursor:pointer; margin-top:20px;"
          onclick="location.href='https://es.planetcalc.com/1434/#google_vignette'">
      </div>

    <div class="marco-retrato dropzone" id="marco-der"></div>

    <div id="mensaje" class="mensaje"></div>

    </div>

    <!-- DERECHA -->
    <div class="lado">
      <div class="zonas-libres">
        <div class="zona-libre" id="zona4">
          <div class="papel-viejo" id="papel4" draggable="true" data-origen="4">
            <img src="img/Maria_de_Borgoña.jpg">
          </div>
        </div>
        <div class="zona-libre" id="zona5">
          <div class="papel-viejo" id="papel5" draggable="true" data-origen="5">
            <img src="img/Carlota_de_Mexico.jpg">
          </div>
        </div>
        <div class="zona-libre" id="zona6">
          <div class="papel-viejo" id="papel6" draggable="true" data-origen="6">
            <img src="img/Josefina_de_Beauharnais.jpg">
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<script>
function activarLatido() {
  document.getElementById("procedimiento").classList.add("latido");
}

function desactivarLatido() {
  document.getElementById("procedimiento").classList.remove("latido");
}
</script>

<script>
let arrastrado = null;
let parejasCompletadas = 0;
const yaUsadas = new Set();

const parejas = {
  "papel1-papel5": 1, // Maximiliano + Carlota
  "papel2-papel6": 2, // Napoleón + Josefina
  "papel3-papel4": 3  // Maximiliano I + María
};

const mensajes = {
  1: "Dos personas, una historia.",
  2: "Cartas de amor, cartas del corazón.",
  3: "Juntos hasta la muerte."
};

const mensajeError = "Estos corazones no laten juntos.";

document.querySelectorAll(".papel-viejo").forEach(p => {
  p.addEventListener("dragstart", () => {
  arrastrado = p;

    if (!p._zonaOriginal) {
      const zona = p.closest(".zona-libre");
      p._zonaOriginal = zona;
    }

  setTimeout(() => p.style.display = "none", 0);
});

  p.addEventListener("dragend", () => {
    p.style.display = "block";
  });
});

document.querySelectorAll(".dropzone").forEach(zona => {
  zona.addEventListener("dragover", e => e.preventDefault());

  zona.addEventListener("drop", e => {
    e.preventDefault();
    if (zona.querySelector(".papel-viejo")) return;
    zona.appendChild(arrastrado);
    setTimeout(evaluar, 200);
  });
});

function evaluar() {
  const izq = document.querySelector("#marco-izq .papel-viejo");
  const der = document.querySelector("#marco-der .papel-viejo");
  if (!izq || !der) return;

  const clave = `${izq.id}-${der.id}`;
  const claveInv = `${der.id}-${izq.id}`;

  if (parejas[clave] && !yaUsadas.has(clave)) {
    exito(parejas[clave], izq, der, clave);
  } else if (parejas[claveInv] && !yaUsadas.has(claveInv)) {
    exito(parejas[claveInv], izq, der, claveInv);
  } else {
    fallo(izq, der);
  }
}

function exito(num, izq, der, clave) {
  yaUsadas.add(clave);
  parejasCompletadas++;

  document.getElementById(`parte${num}`).classList.remove("oculto");

  activarLatido();
  mostrarMensaje(mensajes[num]);

  bloquear(izq);
  bloquear(der);

  devolver(izq);
  devolver(der);

  if (parejasCompletadas === 3) {
    document.getElementById("final-img").style.display = "block";
  }

  setTimeout(desactivarLatido, 2000);
}
  
function fallo(izq, der) {
  mostrarMensaje(mensajeError);
  devolver(izq);
  devolver(der);
}
  
function devolver(p) {
  setTimeout(() => {
    p._zonaOriginal.appendChild(p);
  }, 800);
}

function bloquear(p) {
  p.setAttribute("draggable", false);
  p.style.cursor = "default";
  p.classList.add("bloqueado");
}

function mostrarMensaje(texto) {
  const m = document.getElementById("mensaje");
  m.textContent = texto;
  m.classList.add("visible");
  setTimeout(() => m.classList.remove("visible"), 3000);
}

</script>
  
</body>
</html>
